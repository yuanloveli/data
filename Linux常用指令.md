## Linux常用指令

* ls 显示当前路径下的文件和目录
* ls -a 显示所有文件和目录，包括隐藏的
* ls -l 以列表形式展现
* ls -h 显示文件大小

-----

* pwd 显示当前所在的目录

----

* cd 路径

  绝对路径：从/根路径下操作          /root/Linux

  相对路径：从当前路径下进行操作   ./Linux

-----

* mkdir -p 递归创建目录

  mkdir a b c 一次创建多个目录

-----

* touch 文件名              在当前目录下创建文件

  touch a b c 创建多个文件

-----

* cp 复制文件路径  目标文件路径

  cp -r 复制文件路径  目标文件路径

----

* mv 移动文件 移动之后文件不存在该目录下，相当于windows中的剪切 

  **同时 改名也是mv** 

  mv 复制文件路径  目标文件路径 

----

* rm 移除文件

  rm -f 不再询问yes/no 强制删除

  rm -r 递归删除

-----

* vim 文件名         编辑文件

  i 进入编辑模式  Esc 加:wq 保存退出    :q 不保存退出 :x保存退出（更新时间不变）

----

* 输出重定向  将输出结果保存至目标文件

  ">" 覆盖输出 ">>" 追加输出

---

* cat 文件路径      查看文件内容

  

* cat 文件路径1 文件路劲2 文件路劲n > 目标文件        合并文件

-----

**进阶指令**

* df [-h] (内存显示单位)查看磁盘文件

* free [-m -g] (以M，G为单位)查看内存情况

* head [-n] 文件路径 从首行开始查看文件n行，默认为10

* tail   [-n] 文件路径 从末尾开始查看文件n行，默认为10

  **作用2：tail -f 文件路径 监督文件实时变化**   (文件内容变化不能通过手动添加，手动添加显示不出来)

* less 文件路径    查看文件

* wc [-l -w -c]    统计文件内容信息    默认全加-lwc
  1. l: line 显示行数        常用
  2. w: word 显示单词数
  3. c: bytes  显示字节数

* date 显示当前时间

  用法1：  date           显示当前时间

  用法1：  date +%F         简化显示  2018-3-24

*  cal 输出当前月份日期

  用法1：**cal** 等价于 **cal -1** 输出当前月份日历

  用法2：**cal -3** 输出上个月、当前月份和下个月的日历

  用法3：cal 等价于 **cal -y** 输出本年份所有月的日历

* clear 或者是ctrl+l    **隐藏屏幕指令行，通过滚轮上划可以看到前面的指令**  windows中是真的清除

* 管道  管道符 |  作用： **过滤**   **特殊  扩展处理**    通常需要搭配其它指令配合使用
  1. 过滤：ls / | grep y        显示包含"y"的目录或文件  **常用**
  2. 特殊用法：等价于less,       cat linux.txt | less
  3. 扩展处理： ls / | wc -l  统计目录总个数

-----

##高级指令

* hostname 查看当前操作系统的**主机名** （不是用户名）

  hostnamectl **查看主机信息**   

  修改主机名称：hostnamectl set-hostname 新主机名称（临时）

* id 默认查看当前用户的详细信息

* **ps 显示进程**

  1. **ps - e 显示所有的进程**
  2. **ps -f 显示所有字段，包括隐藏信息**

* top  实时查看进程 按q键退出
  1. 按M，按内存大小排序
  2. 按P，按优先级排序

* du  -sh  目录路径     查看一个目录的真实大小

  -s只显示汇总大小 -h以高可读性显示

* find 寻找的路径范围 -选项  文件或目录的名称（type时 f 代表文件，d代表目录）

  -name 以名称查询        

  find / -name httpd.conf           在/路径下寻找httpd.con的文件或目录（模糊查询）

  -type  以类型查询 

  find / -type f（d）       寻找/路径下的文件(目录)

* kill指令  杀死进程 配合ps指令使用
  1. kill 进程PID
  2. killall 进程名称（模糊杀死进程） 

* ifconfig 查看网卡信息

* reboot 重新启动计算机

  reboot -w 模拟重启，在日志中会有记录 但是不重启

* uptime  显示开机到现在的持续时间

* uname   获取计算机操作系统的相关信息

  语法1：uname            获取操作系统的类型

  语法2：uname -a    获取详细操作系统的信息	

  显示为（操作系统类型，主机名，内核版本，版本发布时间，开源计划）

* netstat -tnlp   查看网络状态信息
  1. -t 只显示tcp协议的连接
  2. -n: 表示将地址从字母组合转化成ip地址，将协议转化成端口号来显示
  3. -l: 过滤出"state(状态)" 列中的值为LISTEN（监听）的连接
  4. -p: 显示连接的PID和进程名称

* man 命令   显示命令的使用方式

-------

## vim编辑器（vi的升级版）

* vim的三种模式，命令模式，编辑模式，末行模式
* vim打开文件的四种方式：

   1. vim 文件路径  作用：打开指定文件
  2. vim +数字  文件路径     作用：打开指定的文件，并将光标移动到指定行
  3. vim +/关键词            作用：打开指定文件，并且高亮显示关键字
  4. vim 文件路径1 文件路径2 作用：同时打开多个文件

---

**命令模式时的操作：**

1. shift+^ 移动到**该行首**
2. shift+$ 移动到**该行末**
3. gg 移动到**首行**
4. G移动到**末行**
5. 翻屏：
   1.  向上翻屏 ：ctrl+b    (before)
   2. 向下翻屏：ctrl+f       (future)



复制光标所在行： 按键yy

粘贴：  按键p

以光标所在行向下复制指定行数，光标所在行为第一行

按键： 数字yy

可视化块复制：按键： ctrl+v 进入选取模式，选中后yy复制，p粘贴



**剪切/删除**

删除光标所在行 按键:dd  **严格意义上是剪切，按p可以粘贴**

以光标所在行向下剪切指定行数，光标所在行为第一行

按键： 数字dd

删除改行，下行不移动上来 

按键：D   (该行变为空白行)

**撤销**  按键:     :u或u (undo)

**恢复**   按键: ctrl+r 

----

## 末行模式

在命令模式中按   ":"  进入末行模式

1. ":w" 保存  ”:w  路径“ 另存为
2. ":q" 退出
3. ":wq" 保存退出
4. ":q!"  强制退出

**搜索**

1.  "/关键词" 会高亮显示   切换上/下高亮结果：N/n   (next)

   取消高亮  "nohl"    (no highlight)

**替换**

:s/搜索的关键词/新的内容                        替换光标所在行第一处符合条件的内容

:s/搜索的关键词/新的内容/g                    替换光标所在行所有符合条件的内容

:%s/搜索的关键词/新的内容                    替换整个文档中每行第一的符合条件的内容

:%s/搜索的关键词/新的内容/g                 替换整个文档中符合条件的内容

   

%表示整个文件   g表示全局(global)



* 显示行号  ":set nu"   (number)   一次性退出下次进来无了

  取消显示行号 "set nonu"

**同时打开多个文件时**

": files"  查看多个文件的名称  %a （at）表示当前编辑文件   #  表示上个编辑文件

":open 文件名"     切换至编辑其它文件

跳转至上一个的文件 ":bp"   （previous）

跳转至下一个的文件 ":bn"     (next)

----

##实用功能

* 开启着色显示与否
  1. 开启：syntax on  一次性  （在末行模式中操作）
  2. 关闭：syntax off

* vim计算器的使用 

  a. 进入编辑模式

  b.按下”crtl+R“,然后输入”=“，此时光标会变到最后一行

  c.输入需要计算的内容，按下回车

## 1  vim配置（重点）

vim是一款编辑器，编辑器也是有配置文件的。

vim配置有三种情况：

​		a.在文件打开的时候在末行模式下输入的配置（临时的）

​		b.个人用户配置（~/.vimrc，如果没有可以自行创建）**优先级比全局配置文件高**

​		c.全局配置文件（/etc/vimrc，vim自带）

**2 异常退出**

当异常退出一个文件时，会生产一个临时文件例如，异常关闭了passwd文件，会产生.passwd.swp

当你每一次下一次进入这个文件时会询问你是否恢复或其它操作，解决方法，删除.passwd.swp，将临时文件删除即可

**3  别名机制**

通过修改配置文件:~/.bashrc，可以创造属于自己的命令，**例如  将cls等价于clear命令**

**注意：修改文件后，需要重新登录该用户才能生效**

**4 vim退出方式**

* ”:x“在文件没有修改的情况下，表示直接退出，在文件修改的情况下表示保存退出

* **如果文件没有被修改，但是使用”:wq“退出的话，文件的修改时间会被更新，”:x“则不会**

  **在没有修改时应使用":x"进行退出**

**5 对文件进行加密**

* 设置密码：  末行模式下 ":X" 
* 解除密码：  末行模式下 ":X"    设置密码时为空

-----------

# Linux自有服务

## 一、运行模式修改

**init 指令的使用：**

* init 0  关机     
* init 3 切换成 纯命令行模式（界面） （临时）
* init 5 切换成 图形界面模式
* init 6 重启

注意 ：init指令的配置文件在 /etc/inittab中（在CentOS 7版么以前，以后的话在配置文件中有提示：

设置永久命令行模式：systemctl set-default muti-user.target

设置永久图形界面模式：systemctl set-default graphical.target

）

若要永久设置为图形界面或命令行界面，将配置文件中的id设置成对应的数字即可。

------

## 二、用户与用户组的管理

1. 管理用户与用户组的三个文件：/etc/passwd 、/etc/group、/etc/shadow

   **/etc/passwd  ：  保存用户的关键信息**（查看主组）

   **/etc/group     ： 保存用户的组的信息**（查看附加组）

   **/etc/shadow  ：保存用户的密码信息** 

2. **添加用户** 

   语法：useradd  选项 用户名

   -g 设置主组，选项的值可以是用户组的id，也可以是组名

   -G 设置附加组，选项的值可以是用户组的id，也可以是组名

   -u  设置用户的标识符，不添加则系统默认从500之后默认分配(类似腾讯QQ号码)

   例如：useradd -g 600 -G 502 -u 666 lisi

3. **修改用户信息**

   语法：usermod 选项 用户名

   -g: 设置主组，选项的值可以是用户组的id，也可以是组名

   -G: 设置附加组，选项的值可以是用户组的id，也可以是组名

   -u:  设置用户的标识符，不添加则系统默认从500之后默认分配(类似腾讯QQ号码)

   -l:    设置用户名    usermod -l 新用户名 被修改用户名

4. **设置用户密码**

   语法：passwd 用户名

5. **切换用户**

   语法：su 【用户名】（root超级用户）     不填默认root

6. 删除用户

   语法：userdel -r 用户名

   -r：连同家目录一起删除，删除干净

   注意，当删除用户为登录用户时，需kill相关进程，或者重启才能删除

   

**用户组的管理：**

1. **用户组的添加（新建一个组）**

   语法：groupadd -g 用户组名称  （新建了一个组，创建用户时可以将它放入这个组）

2. 用户组的修改

   语法：groupmod 选项 用户组名称

   -g 修改组的id数字

   -n 修改用户组名称

3. 用户组的删除

   groupdel 用户名

   注意：当被删除的**用户组**为**某个用户的主组**时，需要移除组内的**所有用户**才能删除**该用户组**

## 三、网络设置

1. 网卡配置文件位置：/etc/sysconfig/network-scripts/

   主要是在/etc/sysconfig/network-scripts/ifcfg-eth0(数字可能有所不同)

   存放快捷方式的文件：/etc/init.d   

   语法：/etc/init.d/【network】 restart

   设置快捷方式：软连接

   ls -s 原始文件路径 快捷方式路径

2. 单个网卡的关闭与开启

   关闭单个网卡：ifdown 网卡名

   开启单个网卡：ifup网卡名

## 四、ssh服务

ssh（**secure shell，安全外壳协议**）两个常用的作用：**远程连接协议、远程文件传输协议**。

ssh服务的配置文件在/etc/ssh/ssh_config

默认端口号22，范围是0-65535

**免费软件：Filezilla** 用来远程文件传输

## 五、主机名修改

* CentOS 7版本以前 修改主机名配置文件在：/etc/sysconfig/network
* 7以后 /etc/hostname

1. 临时修改：hostname 新主机名

2. 永久修改：hostnamectl set-hostname 新主机名

3. 修改配置文件：编辑更改用户名即可     **2，3都需要重启才能生效**    FQDN（全域限定名）

   **注意：永久修改的话，需要在/etc/hosts文件中添加本地域名，防止相关服务找不到本地域名，导致启动失败**

## 六、ntp服务

ntp主要作用：**自动调整时间服务**

手动开启：**ntpdate +需要对准的域名或ip地址**

服务（自动）开启：**systemctl start/stop/restart firewalld.service**   

chkconfig 服务中开启开关机自动启动最好： **systemctl enable firewalld.service**

## 七、防火墙服务

**CenOS7以前防火墙叫：iptables、CenOS7之后叫：firewalld**

服务（自动）开启：**systemctl start/stop/restart firewalld.service**   

chkconfig 服务中开启开关机自动启动最好： **systemctl enable firewalld.service**

##八、rpm软件管理

1. 查询所有安装的软件  rpm -qa |grep 软件关键字

   -q query 查询

   -a all  所有

2. 删除软件 

   语法1：rpm -e 软件名 

   语法2：rpm -e 软件名 --nodeps 忽略依赖关系

3. 安装软件

   rpm -ivh 完整安装包名称

   软件包两种方式获取：1 官网下载  2在光盘（镜像文件）中获取

   2的步骤：

   1.  lsblk    显示块设备信息          找到原始挂载文件位置（sr0 光盘文件）
   1. umount  挂载路径    解除挂载 （相当于u盘弹出，未拔出）
   1. mount 原始挂载路径 新挂载路径
   

## 九、cron计划任务

语法：crontab -选项 

-l 列出当前用户的计划任务

-e 编辑当前用户的计划任务

编辑语法格式：以行为单位，一行为一个计划；

*** * * * * 命令**      时间为 "分 时 日 月 周"；

分：0~59 时：0~23 日：1~31 月：1~12 周：0 ~6  0表示周日

四个符号：

*表示每个数字    -表示连续区间 例如1-3 一至三

/表示每多少个    */10  例如每十天，每十分钟

,表示取值             1，3，4  比如每周一、周三、周四

* 扩展： root 可以添加用户名至**/etc/cron.deny文件（黑名单）**中，使该用户不能编辑自己的计划任务
* 白名单/etc/cron.allow 优先级高于黑名单

# Linux权限管理操作

## 一、权限相关操作

* 查看文件权限

语法：**ls -l 路径  如要查看当前路径下 简写： ll 等价于 ls -l  ./**

第一个"-"表示文件，d表示文件夹，

**-rwxr--r--**  **文件类型文件所有者权限用户组权限其它用户权限 **            **x表示文件可执行 文件类型"s"是套接字，"l"是软连接**

**u（user）：文件所有者的权限操作 g（group）：用户组   o（others）：其它用户  a（all）表示对所有用户操作 不添加时默认为a**

**+表示增加权限  "-"表示减去权限 "="表示将权限等于这个**    **”-R“ 对目录下的文件递归执行相关操作**

* 设置权限

  1. 字母形式设置：

     chmod u+r,g+w,o-e  text.txt    chmod u=rw,g=r,o=---  text.txt      **chagemodify**

  2. 数字形式设置：

     二进制：r：4 w：2  x: 1 无权限：0  将权限添加计算即可          **2，3是不合理的操作,能写不能读**

     chmod 777 a.txt

* 更改用户所有者和用户组

  **（重点）**chown -R  新用户名 文件路径              -R对目录文件下递归

  **例1 将a.txt的用户所有者改为test：chown test /a.txt**         

  chgrp -R 新用户组名 文件路径 

  **例2 将a.txt的用户组改为test：chown test /a.txt** 

  升级一步更改**用户和组**：**chown -R  新用户名:新用户组名 文件路径**  **例1、2:   chown -R test:test /a.txt**

扩展**：sudo 指令

情形：当需要给某些特定用户给予一些特殊指令的操作，例如root给  AA用户 重启操作等

sudo配置文件在/etc/sudoers ，这个文件改不了，

a. **要通过"visudo"（完整，不用添加其它）命令打开修改**

b.在编辑时不建议写直接形式的命令，而是写命令的完成路径。 

c.路径通过which命令查看 1. 进入末行模式 2. 语法："which 命令名称(useradd)"

**在普通用户下查看自己的特殊权限：sudo -l**



# Shell

## 一、shell基础

shell是Linux系统内置的一个免费脚本，提供一系列强大的指令和程序语言设计；

* shell脚本执行规范：
  1. 文件命名规范：后缀以.sh结尾
  2. 编辑时首行#!/bin/bash，告诉系统在这里编译执行
  3. 需要将文件改为可执行文件，（按照需求给用户权限）
  4. 执行方法：./加文件名（文件在当前路径下时）常用

## 二、shell进阶

*  变量

  1. shell中要引用一个变量时需要使用 "$"符号 

     例如: echo $a

  2. readonly 设置变量只读，等价于fanal。

  3. 接收用户输入信息。  语法：read -p 提示信息 变量名       作用给相应变量复制，例如切换用户时提示输入密码。

  4. 删除变量  语法：unset 变量名

  5. 条件判断语句：在shell中需要 fi 结束判断语句

     语法 if condition                           **注意：条件表达式必须要有空格隔开"[" 例如：[ $a -eq 5 ]**

     ​         then  command1

     ​         elif  condition

     ​         else command2

     ​         fi





